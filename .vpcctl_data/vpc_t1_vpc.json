{
  "name": "t1_vpc",
  "cidr": "10.30.0.0/16",
  "bridge": "br-t1-vpc",
  "subnets": [
    {
      "name": "public",
      "cidr": "10.30.1.0/24",
      "ns": "ns-t1_vpc-public",
      "gw": "10.30.1.1",
      "host_ip": "10.30.1.2",
      "veth": "v-t1-vpc-public"
    },
    {
      "name": "private",
      "cidr": "10.30.2.0/24",
      "ns": "ns-t1_vpc-private",
      "gw": "10.30.2.1",
      "host_ip": "10.30.2.2",
      "veth": "v-t1-vpc-privat"
    }
  ],
  "host_iptables": [
    [
      "iptables",
      "-I",
      "FORWARD",
      "-i",
      "br-t1-vpc",
      "-m",
      "comment",
      "--comment",
      "vpcctl:t1_vpc:jump",
      "-j",
      "vpc-t1-vpc"
    ],
    [
      "iptables",
      "-A",
      "vpc-t1-vpc",
      "-s",
      "10.30.0.0/16",
      "-d",
      "10.30.0.0/16",
      "-m",
      "comment",
      "--comment",
      "vpcctl:t1_vpc:intra",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-t",
      "nat",
      "-A",
      "POSTROUTING",
      "-s",
      "10.30.0.0/16",
      "-o",
      "enX0",
      "-m",
      "comment",
      "--comment",
      "vpcctl:t1_vpc:nat",
      "-j",
      "MASQUERADE"
    ],
    [
      "iptables",
      "-A",
      "FORWARD",
      "-i",
      "br-t1-vpc",
      "-o",
      "enX0",
      "-m",
      "comment",
      "--comment",
      "vpcctl:t1_vpc:fwd-out",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-A",
      "FORWARD",
      "-i",
      "enX0",
      "-o",
      "br-t1-vpc",
      "-m",
      "state",
      "--state",
      "ESTABLISHED,RELATED",
      "-m",
      "comment",
      "--comment",
      "vpcctl:t1_vpc:fwd-in",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-A",
      "vpc-t1-vpc",
      "-o",
      "br-t2-vpc",
      "-s",
      "10.30.1.0/24",
      "-d",
      "10.30.1.0/24",
      "-m",
      "comment",
      "--comment",
      "vpcctl:peer:t1_vpc:t2_vpc",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-A",
      "vpc-t1-vpc",
      "-o",
      "br-t2-vpc",
      "-s",
      "10.30.1.0/24",
      "-d",
      "10.40.1.0/24",
      "-m",
      "comment",
      "--comment",
      "vpcctl:peer:t1_vpc:t2_vpc",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-A",
      "vpc-t1-vpc",
      "-o",
      "br-t2-vpc",
      "-s",
      "10.40.1.0/24",
      "-d",
      "10.30.1.0/24",
      "-m",
      "comment",
      "--comment",
      "vpcctl:peer:t1_vpc:t2_vpc",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-A",
      "vpc-t1-vpc",
      "-o",
      "br-t2-vpc",
      "-s",
      "10.40.1.0/24",
      "-d",
      "10.40.1.0/24",
      "-m",
      "comment",
      "--comment",
      "vpcctl:peer:t1_vpc:t2_vpc",
      "-j",
      "ACCEPT"
    ],
    [
      "iptables",
      "-A",
      "vpc-t1-vpc",
      "-o",
      "br-t2-vpc",
      "-m",
      "comment",
      "--comment",
      "vpcctl:peer-drop:t1_vpc:t2_vpc",
      "-j",
      "DROP"
    ]
  ],
  "chain": "vpc-t1-vpc",
  "apps": [
    {
      "ns": "ns-t1_vpc-public",
      "port": 8080,
      "pid": 17803,
      "cmd": [
        "ip",
        "netns",
        "exec",
        "ns-t1_vpc-public",
        "python3",
        "-m",
        "http.server",
        "8080"
      ]
    },
    {
      "ns": "ns-t1_vpc-private",
      "port": 8081,
      "pid": 17816,
      "cmd": [
        "ip",
        "netns",
        "exec",
        "ns-t1_vpc-private",
        "python3",
        "-m",
        "http.server",
        "8081"
      ]
    }
  ],
  "peers": [
    {
      "peer_vpc": "t2_vpc",
      "veth_a": "pv-t1-vpc-t2-va",
      "veth_b": "pv-t1-vpc-t2-vb",
      "allowed": [
        "10.30.1.0/24",
        "10.40.1.0/24"
      ]
    }
  ],
  "nat": {
    "interface": "enX0"
  }
}